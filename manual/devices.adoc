[[devices,Devices]]
== Devices

SmuView supports a wide variety of analog devices. Because of that, some of the
following terms may have a slightly different meaning for different device
types.

A device can contain the following objects:

Channel Group image:icons/document-open-folder.png[width=18,Height=18]::
A device can have no, one or more channel groups. Channel groups normally
corresponds to a physical channel on the device itself.
+
A three output channel power supply for example will have three channel
groups, probably named `1`, `2` and `3`.
+
A multimeter normally doesn't have a channel group.

Channel image:icons/office-chart-area.png[width=18,Height=18]::
A device can have multiple channels. Channels can be in a channel group or
belong to the device itself.
+
A power supply normally has a voltage and a current channel per channel group.
+
A multimeter probably has one channel for the main display and maybe one for a
secondary display.

[[signal]]
Signal image:icons/office-chart-line.png[width=18,Height=18]::
A channel can contain one or more signals. A signal represents the samples
generated by the device.
+
Channels of power supplies, electronic loads and math channels always contain
only one signal with a fixed quantity and unit.
+
Channels of multimeters may contain multiple signals, each one with a unique
quantity, quantity flags and unit.

Controllable image:icons/mixer-front.png[width=18,Height=18]::
A device can have no, one or more controllables. Up to one controllable can
belong to a channel group or to the device itself.
+
A power supplies channel group controllable can probably control the output
voltage and current, enable OVP and OCP and enable the output.

[[config_key]]
Config Key image:icons/configure.png[width=18,Height=18]::
A controllable contains one or more config keys. A config key controls a single
property of the device like the sink current of an electronic load or enables
the output of a power supply channel group. It may be read- and writeable.

This is the start screen, when you start SmuView without any
<<cli,command line parameters>>:

image::Welcome.png[width=610,height=294]

image:numbers/1.png[1,22,22] Connect a new hardware device. +
image:numbers/2.png[2,22,22] Create a new <<user_device,user device>>. +
image:numbers/3.png[3,22,22] Disconnect and close the selected device. All
acquired data will be lost!

[[connect_device, Connect a Device]]
=== Connect a Device

You can connect a hardware device with a dialog or with a
<<cli,command line parameter>>.

When using the dialog, first you’ll need to pick a driver that you want to use
(Step 1, image:numbers/1.png[1,22,22]). In order to do this, you’ll need to
know which driver is used to talk to the device. If you’re unsure, you can
either try the driver which you think may fit best or you can check the
https://sigrok.org/wiki/Supported_hardware[sigrok wiki]. For every supported
device there’s a wiki page, showing you which driver is used.

Once the driver has been chosen, you need to select the interface (Step 2,
image:numbers/2.png[2,22,22]). Please be aware that USB is only usable for
devices that directly communicate over USB. Devices that use USB to emulate a
serial port (like many multimeters) will have their serial port listed in the
serial port drop-down. The GPIB interface option is only available, if you have
built `libsigrok` with `linux-gbip` support under Linux.

In case your device connects via Ethernet, you must supply the IP address and
port. You are also given the option to choose between raw TCP access and using
the VXI protocol. VXI is an industry standard which is mainly used in
professional equipment and the device will most likely let you know that it
supports VXI. If your device however is more of a hobbyist grade device, it’s
more likely that using raw TCP will be the correct choice.

After you selected the appropriate options, clicking the btn:[Scan] button
(Step 3, image:numbers/3.png[3,22,22]) will make SmuView try to connect to the
device with the given settings. If successful, any device(s) found will be shown
in the list box (Step 4, image:numbers/4.png[4,22,22]).

image::ConnectDeviceDialog.png[width=536,height=660]

To avoid having to manually enter the device configuration for a serial port or
Ethernet device every time you want to use it and then having to scan for it,
you can also use the <<cli,command line parameter>> `-d` or `--driver` to have
SmuView scan for it on startup:

[listing, subs="normal"]
smuview -d arachnid-labs-re-load-pro:conn=/dev/ttyUSB0

[listing, subs="normal"]
smuview -d korad-kaxxxxp:conn=/dev/ttyUSB1:force_detect=KORADKA3005PV2.0

TIP: All possible connection parameters are documented in the
https://sigrok.org/wiki/Connection_parameters[sigrok wiki].

Connecting a device for the first time, some default views are shown, like
<<control_view,control views>> and <<data_visualisation,visualisation views>>,
depending on the device type and the features that device supports. You are free
to customize which views are displayed and the position and size of these views.

When reconnecting that device (identified by its name and serial id or
connection string) again, your previous view settings will be restored. To
connect an already known device without its stored settings but with its default
settings, you have to start SmuView with the command line parameter `-c`.

=== Default Functions

When you connect a device, you will get the following default functions:

image::UserDevice.png[width=641,height=221]

image:numbers/1.png[1,22,22] Start/Stop data acquisition for this device. +
image:numbers/2.png[2,22,22] <<export_data,Save acquired data>> to a CSV file. +
image:numbers/3.png[3,22,22] Add a new <<control_view,control view>>. +
image:numbers/4.png[4,22,22] Add a new <<value_panel_view,value panel view>>. +
image:numbers/5.png[5,22,22] Add a new <<time_plot_view,time plot view>>. +
image:numbers/6.png[6,22,22] Add a new <<data_table_view,data table view>>. +
image:numbers/7.png[7,22,22] Create a new <<data_processing,math channel>>. +
image:numbers/8.png[8,22,22] Open the about dialog.

[[export_data,Export Data]]
==== Export Data

All acquired data (<<signal,signals>>) can be saved to a CSV file by clicking
the save button (image:icons/document-save.png[save,22,22]) in the device tab.

There are several options to affect the resulting CSV file. Of course you are able
to choose which signals should be saved. The signals from the current device are
selected by default (image:numbers/1.png[1,22,22]).

Next you can determine how the data of the signals should be arranged. When the
_Combine all timestamps_ option (image:numbers/2.png[2,22,22]) is disabled, four
header rows are generated. The first row indicates the device, the second
indicates the channel group, the third the channel and the fourth identifies the
signal itself. Each signal has two columns: One for the timestamp (in seconds)
and one for the value of the signal at that given time (see
<<csv_simple,table 1>>).

.Formated CSV without any option selected
[[csv_simple]]
[%autowidth,format=csv]
|===
include::data_tables/simple.csv[]
|===

The CSV file produced with the _Combine all timestamps_ option
(image:numbers/2.png[2,22,22]) enabled has also four header rows, similar to the
example above, except that only one timestamp column (1st column) will be
generated for all signals followed by one column for each signal (see
<<csv_combine,table 2>>).

.Formated CSV with the combine option selected
[[csv_combine]]
[%autowidth,format=csv]
|===
include::data_tables/combine.csv[]
|===

When the _Combine all timestamps_ option (image:numbers/2.png[2,22,22]) is
enabled you can also define a _Combination time frame_
(image:numbers/3.png[3,22,22]) which will combine values into one timestamp,
when they fall into the defined time span (see <<csv_combine_30ms,table 3>>).

.Formated CSV with the combined option selected and a time frame of 30 ms
[[csv_combine_30ms]]
[%autowidth,format=csv]
|===
include::data_tables/combine_30ms.csv[]
|===

By enabling the option _Absolute time_ (image:numbers/4.png[4,22,22]), the time
column(s) will contain an absolute timestamp in the format
`yyyy.MM.dd hh:mm:ss.zzz`, otherwise the timestamp will be relative to the start
of the SmuView application in seconds (see <<csv_absolut,table 4>>).

.Formated CSV with the combined and the absolute option selected
[[csv_absolut]]
[%autowidth,format=csv]
|===
include::data_tables/combine_absolute.csv[]
|===

You can also define a custom _CSV separator_ (image:numbers/5.png[5,22,22]) used
as the separation character in the CSV file.

image::SaveSignalsDialog.png[width=450,height=429]

=== Device types

==== Measurement Device

A measurement device can be everything from a multimeter to a thermometer to
a scale.

Most of the measurement devices are not controllable and have no channel groups.

==== Power Supply

Most of the supported  power supplies are controllable and have one or more
channel group with a voltage channel and a current channel. Some power supplies
may have additional channels like for power or frequency. The channels contain
only one signal with a fixed quantity and unit.

Math channels for power, resistance, Wh and Ah are automatically generated if
not provided by the device.

==== Electronic Load

All of the supported loads are controllable and have one channel group with a
voltage channel and a current channel. Some loads may have additional channels
like for power or Ah. The channels contain only one signal with a fixed quantity
and unit.

Math channels for power, resistance, Wh and Ah are automatically generated if
not provided by the device.

==== Oscilloscope

Oscilloscopes aren't supported yet, but will be in the future!

Oscilloscopes have a channel group for each scope channel and one channel per
channel group with a signal for each captured frame. The controllable for a
channel group is responsible for the vertical settings of the correspondig scope
channel. The controllable for the device itself controls the timebase, the
trigger settings and so on.

[[user_device]]
==== User Device

A user device has no hardware device attached to it and is basically a virtual
device. It may contain math channels or visualisation and control views from
other devices to build a custom GUI.
